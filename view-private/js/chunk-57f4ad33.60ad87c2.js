(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57f4ad33"],{"0c58":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"dashboard",attrs:{gutter:10}},[a("div",{staticStyle:{"background-color":"black","line-height":"50px","margin-bottom":"20px","padding-left":"10px",color:"white"}},[t._v("\n\t\t\t主机信息\n\t\t\t"),a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.onSelect},model:{value:t.host,callback:function(e){t.host=e},expression:"host"}},t._l(t.hostSelect,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),a("label",{staticStyle:{"margin-left":"20px"}},[t._v("查看条数")]),t._v("  \n\t\t\t"),a("el-input",{staticStyle:{width:"80px","margin-right":"50px"},attrs:{placeholder:"最大值2000"},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),a("el-button",{attrs:{type:"primary"},on:{click:t.onSelect}},[t._v("查询")])],1),a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"reqPie"}},[t._v("\n\t\t\t\t\tweb攻击类型统计图\n\t\t\t\t")])])],1),a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"never"}},[a("div",{staticStyle:{width:"100%",height:"480px"},attrs:{id:"reqTrend"}},[t._v("\n\t\t\t\t\tweb攻击情况趋势\n\t\t\t\t")])])],1),a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"background-color":"black","line-height":"50px","margin-top":"20px","padding-left":"10px",color:"white"}},[t._v("概况统计")]),a("div",{staticStyle:{"line-height":"30px","margin-top":"20px"}},[a("el-col",{attrs:{span:12}},[t._v("拦截"),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.wafDenyCount))]),t._v("次web攻击")]),a("el-col",{attrs:{span:12}},[t._v("攻击IP地址个数:\n\t\t\t\t\t"),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(t.wafAttackIP))]),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.wafAttackIPCount))])])],1)],1)]),a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"background-color":"black","line-height":"50px","margin-top":"20px","padding-left":"10px",color:"white"}},[t._v("攻击行为统计")]),a("div",{staticStyle:{"line-height":"30px","margin-top":"20px"}},t._l(t.gl_method,function(e,i){return a("el-col",{attrs:{span:8}},[t._v(t._s(e.name)+":"+t._s(e.value)+" 次")])}))]),a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"background-color":"black","line-height":"50px","margin-top":"20px","padding-left":"10px",color:"white"}},[t._v("\n\t\t\t\t详细信息\n\t\t\t\t"),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.searchType,callback:function(e){t.searchType=e},expression:"searchType"}},t._l(t.content_select,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),a("label",{staticStyle:{"margin-left":"20px"}},[t._v("搜索内容")]),t._v("  \n\t\t\t\t"),a("el-input",{staticStyle:{width:"300px","margin-right":"50px"},attrs:{placeholder:"请输入对应的搜索内容"},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}})],1),t._l(t.results,function(e,i){return a("div",{staticClass:"tab-box"},[a("div",{staticClass:"box-left"},[a("el-col",{attrs:{span:24}},[a("h1",{staticStyle:{color:"#00C1DE"}},[a("i",{staticClass:"fa fa-laptop",attrs:{"aria-hidden":"true"}}),t._v("  "+t._s(e.host))]),a("span",{staticStyle:{"font-size":"14px",color:"rgba(0,0,0,.45)"}},[t._v("攻击信息")])]),a("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-tag",[t._v(t._s(e.attack_type))])],1),a("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("span",{staticClass:"fa fa-clock-o",staticStyle:{"font-size":"14px",color:"rgba(0,0,0,.45)"}},[t._v("  "+t._s(e.attack_time))]),a("br")])],1),a("div",{staticClass:"box-right"},[a("div",{staticStyle:{padding:"20px"}},[a("el-col",{attrs:{span:12}},[t._v("请求方法: "+t._s(e.method))]),a("el-col",{attrs:{span:12}},[t._v("访问URL: "+t._s(e.url))]),a("el-col",{attrs:{span:24}},[t._v("拦截设置: "+t._s(e.deny_func))]),a("el-col",{attrs:{span:24}},[t._v("拦截位置: "+t._s(e.position))]),a("el-col",{attrs:{span:24}},[t._v("攻击IP: "+t._s(e.attack_ip))]),a("el-col",{attrs:{span:24}},[t._v("攻击者浏览器: "+t._s(e.user_agent))])],1)])])}),a("pagination",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{pageSizes:t.pageSizes,pageSize:t.pageSize,pageTotal:t.pageTotal,currentPage:t.currentPage},on:{handleSizeChange:t.handleSizeChange,handleCurrentChange:t.handleCurrentChange}})],2)],1)},s=[],n=(a("28a5"),a("ac6a"),a("456d"),a("55dd"),a("cadf"),a("551c"),a("097d"),a("164e")),l=a.n(n);function r(t){for(var e=[],a=0,i=t.length;a<i;a++){var s=t[a];-1===e.indexOf(s)&&e.push(s)}return e}function o(t){var e,a=[],i=[];t.sort();for(var s=0;s<t.length;s++)t[s]!==e?(a.push(t[s]),i.push(1)):i[i.length-1]++,e=t[s];return[a,i]}var c=function(){return a.e("chunk-1e99d797").then(a.bind(null,"8af7"))},h=function(){return a.e("chunk-2d0cf63b").then(a.bind(null,"6407"))},p={data:function(){return{num:100,wafLogResult:[],wafDenyCount:"",wafAttackIP:"",wafAttackIPCount:"",gl_method:[],gl_method_title:[],option:{title:{text:"web攻击类型统计",x:"left"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",data:[]},series:[{name:"攻击类型",type:"pie",radius:"80%",center:["50%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},results:[],pageTable:[],pageSizes:[5,10,20],pageSize:10,pageTotal:0,currentPage:1,hostArr:[],hostObj:{},host:"",hostSelect:[],searchType:"url",content_select:[{label:"攻击类型",value:"attack_type"},{label:"攻击IP",value:"attack_ip"},{label:"攻击时间",value:"attack_time"},{label:"防护主机",value:"host"},{label:"协议类型",value:"scheme"},{label:"请求方法",value:"method"},{label:"攻击者浏览器",value:"user_agent"},{label:"访问URL",value:"url"},{label:"拦截位置",value:"position"},{label:"拦截设置",value:"deny_func"}],searchContent:"",tempContent:[]}},mounted:function(){this.drawPie(this.host)},methods:{handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.results=this.pageTable.slice(0,0+t)},handleCurrentChange:function(t){1===this.pageSize?this.results=this.pageTable.slice(0,t*this.pageSize):this.results=this.pageTable.slice(t*this.pageSize-this.pageSize,t*this.pageSize)},onSelect:function(){this.drawPie(this.host)},drawPie:function(t){var e=this.secReq(this.api.secWafLog+"?num="+this.num,"get",{});if(e.hasOwnProperty("code")&&"ok"===e.code){var a={},i=Object.keys(e.msg),s=[];for(var n in i)if(Object.keys(e.msg[i[n]].re).length>0){a[i[n]]=e.msg[i[n]].re.reverse();var l={};l["label"]=i[n],l["value"]=i[n],s.push(l)}this.hostArr=i,this.hostObj=a,this.host=i[0],this.hostSelect=s;var r=Object.keys(a)[0];""==t?this.initData(r):this.initData(t)}else this.$notify({type:"warning",title:"提示",message:l.msg,duration:4e3})},initData:function(t){var e=[],a=[],i=[],s=[],n={"01":0,"02":0,"03":0,"04":0,"05":0,"06":0,"07":0,"08":0,"09":0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,"00":0};for(var c in this.hostObj[t]){var h,p=this.hostObj[t][c].split("\t"),u={},d=p[10],g=d.split(" ")[2].split("-");if(g.length>1)h=g[g.length-1].slice(0,-1)||"";else{var f=g[0].slice(1,-1);switch(String(f)){case"0":h="HPP";break;case"-1":h="Host_Method";break;default:h="CC";break}}u["attack_type"]=h,u["attack_ip"]=p[0],u["attack_time"]=p[2],u["host"]=p[3],u["scheme"]=p[4],u["method"]=p[5],u["user_agent"]=p[6],u["url"]=p[8],u["position"]=d.split(" ")[0],u["deny_func"]=d.split(" ")[1],a.push(p[0]),i.push(h),s.push(p[2]),e.push(u);var v=p[2].split(" ")[1].split(":")[0];for(var c in n)v===c&&(n[c]=n[c]+1)}this.pageTable=e,this.pageTotal=e.length,this.results=e.slice(0,this.pageSize),this.tempContent=e,this.wafDenyCount=this.hostObj[t].length,this.wafAttackIP=r(a),this.wafAttackIPCount=r(a).length;var b=o(i);for(var c in this.gl_method_title=[],this.gl_method=[],b[0]){var m=String(b[0][c]),_=parseInt(b[1][c]);this.gl_method_title.push(m),this.gl_method.push({name:m,value:_})}var S=document.getElementById("reqPie"),y=l.a.init(S);this.option.legend.data=this.gl_method_title,this.option.series[0].data=this.gl_method,y.setOption(this.option);var x=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","00"],k=[];for(var c in x)k.push(n[x[c]]);var w=document.getElementById("reqTrend"),C=l.a.init(w),L={title:{text:"web攻击趋势",x:"left"},tooltip:{trigger:"item",formatter:" {c}"},xAxis:{type:"category",data:x},yAxis:{type:"value"},series:[{data:k,type:"line"}]};C.setOption(L)}},components:{wafCard:c,pagination:h},watch:{$route:function(t,e){},searchContent:{handler:function(t,e){if(""!==this.searchType)if(""===t)this.results=this.tempContent;else{var a=this.searchType;this.results=this.tempContent.filter(function(e){if(e[a].indexOf(t)>=0)return!0})}}}}},u=p,d=(a("b0f7"),a("2877")),g=Object(d["a"])(u,i,s,!1,null,null,null);e["default"]=g.exports},"2f21":function(t,e,a){"use strict";var i=a("79e5");t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},"456d":function(t,e,a){var i=a("4bf8"),s=a("0d58");a("5eda")("keys",function(){return function(t){return s(i(t))}})},"477d":function(t,e,a){},"55dd":function(t,e,a){"use strict";var i=a("5ca1"),s=a("d8e8"),n=a("4bf8"),l=a("79e5"),r=[].sort,o=[1,2,3];i(i.P+i.F*(l(function(){o.sort(void 0)})||!l(function(){o.sort(null)})||!a("2f21")(r)),"Array",{sort:function(t){return void 0===t?r.call(n(this)):r.call(n(this),s(t))}})},"5eda":function(t,e,a){var i=a("5ca1"),s=a("8378"),n=a("79e5");t.exports=function(t,e){var a=(s.Object||{})[t]||Object[t],l={};l[t]=e(a),i(i.S+i.F*n(function(){a(1)}),"Object",l)}},ac6a:function(t,e,a){for(var i=a("cadf"),s=a("0d58"),n=a("2aba"),l=a("7726"),r=a("32e9"),o=a("84f2"),c=a("2b4c"),h=c("iterator"),p=c("toStringTag"),u=o.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=s(d),f=0;f<g.length;f++){var v,b=g[f],m=d[b],_=l[b],S=_&&_.prototype;if(S&&(S[h]||r(S,h,u),S[p]||r(S,p,b),o[b]=u,m))for(v in i)S[v]||n(S,v,i[v],!0)}},b0f7:function(t,e,a){"use strict";var i=a("477d"),s=a.n(i);s.a}}]);