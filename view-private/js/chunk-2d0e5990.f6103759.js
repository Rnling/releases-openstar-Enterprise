(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5990"],{"94ba":function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",[s("el-card",{attrs:{shadow:"never"}},[s("wafDomainDiag",{ref:"addDiag",on:{diagAdd:t.addData,diagEdit:t.addData}}),s("el-row",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},attrs:{gutter:10}},[s("div",{staticStyle:{width:"300px",float:"left"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.ruleSearch,callback:function(i){t.ruleSearch=i},expression:"ruleSearch"}})],1),s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:function(i){t.viewDiag()}}},[t._v("添加域名")]),s("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.saveRule}},[t._v("保存为JSON")])],1)]),s("wafDivider"),s("el-row",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-left":"10px"},attrs:{gutter:10}},[s("wafDomainTable",{ref:"wafTable",attrs:{data:t.data},on:{del:t.delData,edit:t.viewDiag}})],1)],1)],1)},a=[],o=(s("6b54"),function(){return s.e("chunk-24bbae2e").then(s.bind(null,"0882"))}),r=function(){return s.e("chunk-2d21049c").then(s.bind(null,"b6f8"))},d=function(){return s.e("chunk-2d0e5b74").then(s.bind(null,"9656"))},n={data:function(){return{ruleSearch:"",temp:[],data:[],count:0}},mounted:function(){this.initConfig()},methods:{saveRule:function(){var t=this.secReq(this.api.save2js,"post",{action:"save",mod:"nginx_Mod"});t.hasOwnProperty("code")&&"ok"===t.code?this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3}):this.$notify({type:"warning",title:"提示",message:t.msg,duration:4e3})},initConfig:function(){var t,i;if(t={host:"all_host",cer:!0},i=this.secReq(this.api.domainManage1+"/get","post",t),"ok"==i.code){var s=[];for(var e in i.msg)if("state"!==e&&"count"!==e){var a={};a.host=i.msg[e].host,a.proxy_protocol=i.msg[e].proxy_protocol,a.protocol=i.msg[e].protocol,a.protect="on",a.isRewrite_https=i.msg[e].isRewrite_https,a.port=i.msg[e].port,a.cname=i.msg[e].cname,a.ips=i.msg[e].ips.toString(),a.ssl_certificate=i.msg[e].ssl.ssl_certificate,a.ssl_certificate_key=i.msg[e].ssl.ssl_certificate_key,a.ssl_verify_client=i.msg[e].ssl.ssl_verify_client,a.ssl_client_certificate=i.msg[e].ssl.ssl_client_certificate,a.isHttp2=i.msg[e].isHttp2,s.push(a)}this.data=s,this.temp=s,this.count=this.data.length}else this.$notify({type:"warning",title:"提示",message:i.msg,duration:4e3})},viewDiag:function(t){void 0===t?(this.$refs.addDiag.title="添加",this.$refs.addDiag.host="",this.$refs.addDiag.editRule=!1,this.$refs.addDiag.proxy_protocol="http",this.$refs.addDiag.protocol="http",this.$refs.addDiag.protocolShow=!0,this.$refs.addDiag.isRewrite_https=!1,this.$refs.addDiag.port=80,this.$refs.addDiag.cname="cname_ip",this.$refs.addDiag.ips="",this.$refs.addDiag.ssl_certificate="",this.$refs.addDiag.ssl_certificate_key="",this.$refs.addDiag.isHttp2=!0,this.$refs.addDiag.advanceShow=!1):(this.$refs.addDiag.title="编辑",this.$refs.addDiag.host=t.host,this.$refs.addDiag.editRule=!0,this.$refs.addDiag.proxy_protocol=t.proxy_protocol,this.$refs.addDiag.protocol=t.protocol,"https"===this.$refs.addDiag.protocol?this.$refs.addDiag.protocolShow=!1:this.$refs.addDiag.protocolShow=!0,this.$refs.addDiag.isRewrite_https=t.isRewrite_https,this.$refs.addDiag.port=t.port,this.$refs.addDiag.cname="cname_ip",this.$refs.addDiag.ips=t.ips,this.$refs.addDiag.ssl_certificate=this.b64Decode(t.ssl_certificate),this.$refs.addDiag.ssl_certificate_key=this.b64Decode(t.ssl_certificate),this.$refs.addDiag.isHttp2=!0,this.$refs.addDiag.advanceShow=!0),this.$refs.addDiag.wafRuleVisible=!0},addData:function(){var t,i;"http"===this.$refs.addDiag.protocol?t={host:this.$refs.addDiag.host,ips:this.$refs.addDiag.ips,isRewrite_https:this.$refs.addDiag.isRewrite_https,port:this.port,protocol:this.$refs.addDiag.protocol,proxy_protocol:this.$refs.addDiag.proxy_protocol}:"https"===this.$refs.addDiag.protocol&&(t={host:this.$refs.addDiag.host,ips:this.$refs.addDiag.ips,isHttp2:!0,port:this.$refs.addDiag.port,protocol:this.$refs.addDiag.protocol,proxy_protocol:this.$refs.addDiag.proxy_protocol,ssl_certificate:encodeURIComponent(this.b64Encode(this.$refs.addDiag.ssl_certificate)),ssl_certificate_key:encodeURIComponent(this.b64Encode(this.$refs.addDiag.ssl_certificate_key))}),"添加"===this.$refs.addDiag.title?i=this.secReq(this.api.domainManage+"/add","post",t):"编辑"===this.$refs.addDiag.title?i=this.secReq(this.api.domainManage+"/set","post",t):"高级编辑"===this.$refs.addDiag.title&&(t={host:this.$refs.addDiag.host,protocol:this.$refs.addDiag.protocol,type:!0,value:encodeURIComponent(this.b64Encode(this.$refs.addDiag.advance))},i=this.secReq(this.api.domainManage+"/set","post",t)),"ok"==i.code?(this.initConfig(),this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3})):this.$notify({type:"warning",title:"提示",message:i.msg,duration:4e3}),this.$refs.addDiag.wafRuleVisible=!1},editData:function(){},delData:function(t){var i,s;i={host:t.host,protocol:t.protocol},s=this.secReq(this.api.domainManage+"/del","post",i),"ok"==s.code?(this.initConfig(),this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3})):this.$notify({type:"warning",title:"提示",message:s.msg,duration:4e3})}},components:{wafDivider:o,wafDomainTable:r,wafDomainDiag:d},watch:{$route:function(t,i){},ruleSearch:{handler:function(t,i){this.data=""===t?this.temp:this.temp.filter(function(i){if(i.host.indexOf(t)>=0)return!0})}}}},c=n,h=s("2877"),l=Object(h["a"])(c,e,a,!1,null,null,null);i["default"]=l.exports}}]);