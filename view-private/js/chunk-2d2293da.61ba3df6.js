(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2293da"],{dd37:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-card",{attrs:{shadow:"never"}},[i("el-dialog",{attrs:{title:t.title,visible:t.pageVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(e){t.pageVisible=e}}},[i("div",{staticClass:"modal-body"},[i("el-row",{staticClass:"custom-col"},[i("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t域名:\n\t\t\t\t\t")]),i("el-col",{attrs:{span:14}},[i("el-input",{attrs:{disabled:t.addTile},model:{value:t._$domain,callback:function(e){t._$domain=e},expression:"_$domain"}})],1)],1),i("el-row",{staticClass:"custom-col"},[i("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\tIP:\n\t\t\t\t\t")]),i("el-col",{attrs:{span:14}},[i("el-input",{attrs:{disabled:t.editTile},model:{value:t.ip,callback:function(e){t.ip=e},expression:"ip"}})],1),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[i("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v(" ip 不支持ip段，仅支持单ip\n\t\t\t\t\t")])],1),i("el-row",{directives:[{name:"show",rawName:"v-show",value:"添加"===t.title,expression:"title === '添加' "}],staticClass:"custom-col"},[i("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t时间/秒:\n\t\t\t\t\t")]),i("el-col",{attrs:{span:14}},[i("el-input",{model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[i("label",{staticStyle:{float:"right","line-height":"40px"}},[i("span",{staticStyle:{color:"red"}},[t._v("* 默认0 为永久")])])])],1),i("el-row",{staticClass:"custom-col"},[i("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t匹配动作:\n\t\t\t\t\t")]),i("el-col",{attrs:{span:14}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.ip_value,callback:function(e){t.ip_value=e},expression:"ip_value"}},t._l(this.$store.state.action_options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.pageVisible=!1}}},[t._v("取 消")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"添加"===t.title,expression:"title === '添加' "}],attrs:{type:"primary"},on:{click:function(e){t.setData("添加")}}},[t._v("添加")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑"===t.title,expression:"title === '编辑' "}],attrs:{type:"primary"},on:{click:function(e){t.setData("编辑")}}},[t._v("编辑")])],1)]),i("el-row",{staticStyle:{"margin-bottom":"20px","margin-left":"10px"},attrs:{gutter:10}},[i("div",{staticStyle:{width:"300px",float:"left"}},[i("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.ruleSearch,callback:function(e){t.ruleSearch=e},expression:"ruleSearch"}})],1),i("div",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.showDiag}},[t._v("添加规则")]),i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.saveRule}},[t._v("保存为JSON")])],1)]),i("wafDivider"),i("el-row",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-left":"10px"},attrs:{gutter:10}},[i("el-col",{attrs:{span:4}},[t._v("\n\t\t\t\tip规则配置: \n\t\t\t\t"),i("el-tooltip",{attrs:{content:t.state,placement:"top"}},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off"},on:{change:t.stateClick},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}})],1)],1),i("el-col",{attrs:{span:4}},[i("span",{staticStyle:{color:"red"}},[t._v("\n\t\t\t\t\t(点击应用生效)\n\t\t\t\t")]),t._v("\n\t\t\t\t当前数量：\n\t\t\t\t"),i("i",{staticClass:"red-fonts"},[t._v("\n\t\t\t\t\t"+t._s(t.count?t.count:0)+"\n\t\t\t\t")])])],1),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"tooltip-effect":"dark",data:t.results}},[i("el-table-column",{attrs:{label:"域名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.host)+"\n\t\t\t\t")]}}])}),i("el-table-column",{attrs:{label:"ip"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.ip)+"\n\t\t\t\t")]}}])}),i("el-table-column",{attrs:{label:"动作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t"+t._s(e.row.option)+"\n\t\t\t\t")]}}])}),i("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(i){t.delData(e.row)}}},[i("i",{staticClass:"fa fa-close"}),t._v(" 删除")])]}}])})],1)],1)],1)},a=[],n=(i("28a5"),i("cadf"),i("551c"),i("097d"),function(){return i.e("chunk-24bbae2e").then(i.bind(null,"0882"))}),l=function(){return i.e("chunk-321b258d").then(i.bind(null,"0777"))},o={data:function(){return{_$domain:"",ip:"",time:0,ip_value:"deny",addTile:!1,editTile:!1,ruleSearch:"",temp:[],state:"on",count:0,results:[],title:"",pageVisible:!1}},mounted:function(){this.initData()},methods:{saveRule:function(){var t=this.secReq(this.api.save2js,"post",{action:"save",mod:"ip_Mod"});t.hasOwnProperty("code")&&"ok"===t.code?this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3}):this.$notify({type:"warning",title:"提示",message:t.msg,duration:4e3})},initData:function(){var t=this.secReq(this.api.defIPselect,"post",{action:"get",ip:"all_ip"});if("ok"===t.code){this.count=t.msg.count,this.state=t.msg.state;var e=[];for(var i in t.msg)if("state"!==i&&"count"!==i){var s={},a=i.split("_");1==a.length?(s.host="*",s.ip=a[0]):(s.host=a[0],s.ip=a[1]),s.option=t.msg[i],e.push(s)}this.results=e,this.temp=e}else this.$notify({type:"warning",title:"提示",message:t.msg,duration:4e3})},stateClick:function(){var t,e;"on"===this.state?(t={action:"set",mod:"base",id:"ip_Mod",value:"on"},e=this.secReq(this.api.globalConfig,"post",t),"ok"==e.code?(this.state="on",this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3})):this.$notify({type:"warning",title:"提示",message:e.msg,duration:4e3})):"off"===this.state&&(t={action:"set",mod:"base",id:"ip_Mod",value:"off"},e=this.secReq(this.api.globalConfig,"post",t),"ok"==e.code?(this.state="off",this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3})):this.$notify({type:"warning",title:"提示",message:e.msg,duration:4e3}))},delData:function(t){var e,i,s;s="*"===t.host?t.ip:t.host+"_"+t.ip,e={action:"del",ip:String(s)},i=this.secReq(this.api.defIP,"post",e),"ok"==i.code?(this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3}),this.initData()):this.$notify({type:"warning",title:"提示",message:i.msg,duration:4e3})},showDiag:function(){this._$domain="*",this.editTile=!1,this.time=0,this.ip="",this.ip_value="deny",this.title="添加",this.pageVisible=!0},editDiag:function(t,e){this._$domain=t.host,this.editTile=!0,this.ip=t.ip,this.ip_value=t.option,this.title="编辑",this.pageVisible=!0},setData:function(t){var e,i,s;"添加"===t?(e="*"===this._$domain?this.ip:this._$domain+"_"+this.ip,i=this.ip_value,s=this.secReq(this.api.defIP,"post",{action:"set",ip:e,time:this.time,value:i})):"编辑"===t&&(e="*"===this._$domain?this.ip:this._$domain+"_"+this.ip,i=this.ip_value,s=this.secReq(this.api.defIP,"post",{action:"set",ip:e,value:i})),"ok"===s.code?(this.$notify({type:"success",title:"提示",message:"应用成功",duration:4e3}),this.initData()):this.$notify({type:"warning",title:"提示",message:s.msg,duration:4e3}),this.pageVisible=!1}},filters:{},components:{wafDivider:n,wafRealipDiag:l},watch:{$route:function(t,e){},ruleSearch:{handler:function(t,e){this.results=""===t?this.temp:this.results.filter(function(e){if(e.host.indexOf(t)>=0)return!0})}}}},c=o,r=i("2877"),p=Object(r["a"])(c,s,a,!1,null,null,null);e["default"]=p.exports}}]);