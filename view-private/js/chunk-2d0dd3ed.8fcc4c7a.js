(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd3ed"],{8120:function(t,e,l){"use strict";l.r(e);var i=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("el-dialog",{attrs:{title:t.title,visible:t.wafRuleVisible,width:"50%","before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.wafRuleVisible=e}}},[l("div",{staticClass:"modal-body col-sm-12"},[l("el-dialog",{attrs:{title:t.ruleTitle+"选项:",visible:t.contentVisible,width:"45%","append-to-body":""},on:{"update:visible":function(e){t.contentVisible=e}}},[l("div",{directives:[{name:"show",rawName:"v-show",value:t.headerVisible,expression:"headerVisible"}],staticStyle:{"margin-bottom":"20px"}},[l("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:20}},[l("el-col",{attrs:{span:12}},[l("label",{staticClass:"label",staticStyle:{"line-height":"40px"}},[t._v("header属性:\n\t\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入内容"},model:{value:t.headerContentArr[0],callback:function(e){t.$set(t.headerContentArr,0,e)},expression:"headerContentArr[0]"}})],1)]),l("el-col",{attrs:{span:12}},[l("label",{staticClass:"label",staticStyle:{"line-height":"40px"}},[t._v("出现位置:\n\t\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入内容"},model:{value:t.headerContentArr[1],callback:function(e){t.$set(t.headerContentArr,1,e)},expression:"headerContentArr[1]"}})],1)]),l("el-col",{staticStyle:{"margin-top":"20px"},attrs:{span:24}},[l("h5",[l("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("   header属性: 查找的header属性；默认参数：string")])]),l("el-col",{attrs:{span:24}},[l("h5",[l("span",{staticStyle:{color:"red"}},[t._v("*")]),t._v("   出现位置：查找的header属性出现的位置；默认参数any/end")])])],1),l("div",{directives:[{name:"show",rawName:"v-show",value:""===t.ruleTitle,expression:"ruleTitle === '' "}],staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[l("label",{staticClass:"label",staticStyle:{"line-height":"40px"}},[t._v("匹配的内容等于:\n\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入内容"},model:{value:t.headerValue,callback:function(e){t.headerValue=e},expression:"headerValue"}})],1)]),l("div",{directives:[{name:"show",rawName:"v-show",value:"in"===t.ruleTitle,expression:"ruleTitle === 'in' "}],staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[l("label",{staticClass:"label",staticStyle:{"line-height":"40px"}},[t._v("匹配的内容包含:\n\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入内容"},model:{value:t.headerValue,callback:function(e){t.headerValue=e},expression:"headerValue"}})],1)]),l("div",{directives:[{name:"show",rawName:"v-show",value:"@token@"===t.ruleTitle,expression:"ruleTitle === '@token@' "}],staticStyle:{"margin-top":"20px","margin-bottom":"20px"}},[l("el-input",{attrs:{placeholder:"true",disabled:""},model:{value:t.headerValue,callback:function(e){t.headerValue=e},expression:"headerValue"}})],1)],1),l("div",{directives:[{name:"show",rawName:"v-show",value:"reg"===t.ruleTitle,expression:"ruleTitle === 'reg' "}]},[l("el-row",[l("el-col",{attrs:{span:24}},[l("div",{staticStyle:{"margin-bottom":"10px"}},[t._v("正则参数：")]),l("el-checkbox-group",{model:{value:t.regCheckList,callback:function(e){t.regCheckList=e},expression:"regCheckList"}},t._l(t.jioContent,function(e,i){return l("div",{key:i},[i<3?l("el-col",{attrs:{span:8}},[l("el-checkbox",{attrs:{label:e}},[t._v(" "+t._s(e.label)+" ")])],1):l("div",[l("div",3===i?[l("el-col",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"},attrs:{span:24}},[l("WafDivider")],1)]:[l("el-col",{attrs:{span:12}},[l("el-checkbox",{attrs:{label:e}},[t._v(" "+t._s(e.label)+" ")])],1)],1)])],1)}))],1)],1),l("el-row",[l("el-col",{attrs:{span:24}},[l("div",{staticStyle:{"margin-bottom":"10px","margin-top":"20px"}},[t._v("正则匹配内容：")]),l("div",[l("el-input",{attrs:{placeholder:"请输入正则表达式"},model:{value:t.regContentValue,callback:function(e){t.regContentValue=e},expression:"regContentValue"}})],1)])],1)],1),l("div",{directives:[{name:"show",rawName:"v-show",value:"list"===t.ruleTitle||"in_list"===t.ruleTitle||"start_list"===t.ruleTitle||"end_list"===t.ruleTitle||"rein_list"===t.ruleTitle,expression:"ruleTitle === 'list' || ruleTitle === 'in_list' || ruleTitle === 'start_list' || ruleTitle === 'end_list' || ruleTitle === 'rein_list' "}]},[l("div",{staticStyle:{width:"100%"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入内容"},model:{value:t.listContentValue,callback:function(e){t.listContentValue=e},expression:"listContentValue"}}),l("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",round:""},on:{click:function(e){t.addList(t.ruleTitle)}}},[t._v("添加")])],1),t._l(t.listContentArr,function(e,i){return l("div",{staticStyle:{width:"100%","margin-top":"10px"}},[l("el-input",{staticStyle:{width:"80%"},attrs:{value:e,disabled:""}}),l("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",round:""},on:{click:function(e){t.removeList(t.ruleTitle,i)}}},[t._v("删除")])],1)})],2),l("div",{directives:[{name:"show",rawName:"v-show",value:"dict"===t.ruleTitle,expression:"ruleTitle === 'dict' "}]},[l("div",{staticStyle:{width:"100%"}},[l("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入内容"},model:{value:t.dictContentValue,callback:function(e){t.dictContentValue=e},expression:"dictContentValue"}}),l("select",{directives:[{name:"model",rawName:"v-model",value:t.dictNegate,expression:"dictNegate"}],staticStyle:{width:"20%",height:"39px"},on:{change:function(e){var l=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.dictNegate=e.target.multiple?l:l[0]}}},[l("option",{attrs:{value:"true"}},[t._v("true")]),l("option",{attrs:{value:"false"}},[t._v("false")])]),l("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",round:""},on:{click:function(e){t.addList(t.ruleTitle)}}},[t._v("添加")])],1),t._l(t.dictContentArr,function(e,i,a){return l("div",{staticStyle:{width:"100%","margin-top":"10px"}},[l("div",{staticStyle:{width:"80%",height:"40px",border:"1px solid #dcdfe6","text-align":"center","line-height":"40px",display:"inline-block"}},[t._v(t._s(i)+":"+t._s(e))]),l("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",round:""},on:{click:function(e){t.removeList(t.ruleTitle,i)}}},[t._v("删除")])],1)})],2),l("div",{directives:[{name:"show",rawName:"v-show",value:"len"===t.ruleTitle,expression:"ruleTitle === 'len' "}]},[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:12}},[l("label",{staticClass:"label",staticStyle:{height:"40px","line-height":"40px"}},[t._v("值1:\n\t\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},model:{value:t.lenContentArr[0],callback:function(e){t.$set(t.lenContentArr,0,e)},expression:"lenContentArr[0]"}})],1)]),l("el-col",{attrs:{span:12}},[l("label",{staticClass:"label",staticStyle:{height:"40px","line-height":"40px"}},[t._v("值2:\n\t\t\t\t\t\t\t\t"),l("el-input",{staticStyle:{width:"80%"},model:{value:t.lenContentArr[1],callback:function(e){t.$set(t.lenContentArr,1,e)},expression:"lenContentArr[1]"}})],1)]),l("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:24}},[l("h5",[l("span",{staticStyle:{color:"red"}},[t._v("* ")]),l("span",[t._v("值1: 表示长度等于大于的数字(>=); ")])])]),l("el-col",{attrs:{span:24}},[l("h5",[l("span",{staticStyle:{color:"red"}},[t._v("* ")]),l("span",[t._v("值2:表示长度等于小于的数字(<=)")])])])],1)],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{type:"primary"},on:{click:t.pushContent}},[t._v("确 定")]),l("el-button",{on:{click:function(e){t.contentVisible=!1}}},[t._v("取 消")])],1)]),l("el-form",{attrs:{model:t.ruleForm}},[l("el-form-item",{attrs:{label:"规则名称","label-width":"80px"}},[l("el-input",{attrs:{autocomplete:"off"},model:{value:t.ruleForm.id,callback:function(e){t.$set(t.ruleForm,"id",e)},expression:"ruleForm.id"}})],1),l("el-form-item",{attrs:{label:"规则类型","label-width":"80px"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.typeValue,callback:function(e){t.typeValue=e},expression:"typeValue"}},t._l(this.$store.state.typeOptions,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),l("el-form-item",{attrs:{label:"规则开关","label-width":"80px"}},[l("el-switch",{model:{value:t.ruleForm.state,callback:function(e){t.$set(t.ruleForm,"state",e)},expression:"ruleForm.state"}})],1)],1),l("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.ruleForm.table}},[l("el-table-column",{attrs:{label:"匹配条件",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("div",{directives:[{name:"show",rawName:"v-show",value:"host"===e.row.name,expression:"scope.row.name === 'host' "}]},[t._v("\n\t\t\t\t\t\t\thost\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"uri"===e.row.name,expression:"scope.row.name === 'uri' "}]},[t._v("\n\t\t\t\t\t\t\turi\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"referer"===e.row.name,expression:"scope.row.name === 'referer' "}]},[t._v("\n\t\t\t\t\t\t\treferer\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"header"===e.row.name,expression:"scope.row.name === 'header' "}]},[t._v("\n\t\t\t\t\t\t\theader\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"useragent"===e.row.name,expression:"scope.row.name === 'useragent' "}]},[t._v("\n\t\t\t\t\t\t\tuseragent\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"cookie"===e.row.name,expression:"scope.row.name === 'cookie' "}]},[t._v("\n\t\t\t\t\t\t\tcookie\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"args"===e.row.name,expression:"scope.row.name === 'args' "}]},[t._v("\n\t\t\t\t\t\t\targs\n\t\t\t\t\t\t")]),l("div",{directives:[{name:"show",rawName:"v-show",value:"post"===e.row.name,expression:"scope.row.name === 'post' "}]},[t._v("\n\t\t\t\t\t\t\tpost\n\t\t\t\t\t\t")])]}}])}),l("el-table-column",{attrs:{label:"匹配符",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-input",{attrs:{disabled:!0},model:{value:e.row.symbol,callback:function(l){t.$set(e.row,"symbol",l)},expression:"scope.row.symbol"}},[l("el-select",{staticStyle:{width:"160px"},attrs:{slot:"prepend"},on:{change:function(l){t.selectSymbol(e.$index)}},slot:"prepend",model:{value:e.row.symbol,callback:function(l){t.$set(e.row,"symbol",l)},expression:"scope.row.symbol"}},t._l(t.symbol_options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),"reg"==e.row.symbol?l("div",{staticStyle:{color:"red"}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.row.jioRegData)+"\n\t\t\t\t\t\t")]):t._e()]}}])}),l("el-table-column",{attrs:{label:"取反",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-select",{model:{value:e.row.negate,callback:function(l){t.$set(e.row,"negate",l)},expression:"scope.row.negate"}},t._l(t.negate_options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]}}])}),l("el-table-column",{attrs:{label:"内容","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[l("div",{on:{click:function(l){t.selectContent(e.row,e.$index)}}},["@token@"==e.row.symbol?l("div",[l("el-input",{attrs:{placeholder:"请输入内容",disabled:e.row.disabled},model:{value:e.row.content,callback:function(l){t.$set(e.row,"content",l)},expression:"scope.row.content"}})],1):l("div",[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.row.content,callback:function(l){t.$set(e.row,"content",l)},expression:"scope.row.content"}})],1)])]}}])})],1),l("el-row",{staticStyle:{"margin-top":"30px","margin-bottom":"0px"}},[l("el-col",{attrs:{span:12}},[l("label",{staticClass:"label",staticStyle:{height:"40px","line-height":"40px"}},[t._v("匹配动作:\n\t\t\t\t\t\t"),l("el-select",{attrs:{placeholder:"请选择"},model:{value:t.ruleForm.action,callback:function(e){t.$set(t.ruleForm,"action",e)},expression:"ruleForm.action"}},t._l(t.action_options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.wafRuleVisible=!1}}},[t._v("取 消")]),l("el-button",{directives:[{name:"show",rawName:"v-show",value:"添加"===t.title,expression:"title === '添加' "}],attrs:{type:"primary"},on:{click:t.addRule}},[t._v("添加")]),l("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑"===t.title,expression:"title === '编辑' "}],attrs:{type:"primary"},on:{click:t.addRule}},[t._v("编辑")])],1)])},a=[],r=(l("6b54"),l("7f7f"),l("a481"),function(){return l.e("chunk-24bbae2e").then(l.bind(null,"0882"))}),n={data:function(){return{editorId:0,title:"添加",wafRuleVisible:!1,ruleTitle:"",contentVisible:!1,ruleForm:{},typeValue:"",rulenameIndex:0,regCheckList:[],regContentValue:"",listContentValue:"",listContentArr:[],dictContentValue:"",dictNegate:!0,dictContentArr:{},lenContentArr:[0,0],headerValue:"",headerVisible:!1,headerContentArr:["sessionss","any"],negate_options:[{value:!1,label:"false"},{value:!0,label:"true"}],symbol_options:[{value:"reg",label:"正则"},{value:"in",label:"包含"},{value:"list",label:"数组"},{value:"in_list",label:"包含列表"},{value:"start_list",label:"开头列表"},{value:"end_list",label:"结尾列表"},{value:"dict",label:"字典"},{value:"",label:"等于"},{value:"rein_list",label:"包含扩展列表"},{value:"len",label:"长度"},{value:"@token@",label:"token"}],jioContent:[{label:"大小写敏感 i",name:"i",index:0},{label:"启用JIT编译 j",name:"j",index:1},{label:"缓存 o",name:"o",index:2},{label:"单行模式 s",name:"s",index:3},{label:"锚定模式 a",name:"a",index:4},{label:"DFA模式 d",name:"d",index:5},{label:"扩展模式 x",name:"x",index:6},{label:"允许重复命名子模式 D",name:"D",index:7},{label:"启用Javescript兼容模式 J",name:"J",index:8},{label:"UTF-8模式 u * 需要PCRE库加上--enable-utf8",name:"u",index:9},{label:"UTF-8模式 U  * 同u模式，但不进行字符串有效性检查",name:"U",index:10}],action_options:[{value:"log",label:"log"},{value:"allow",label:"allow"},{value:"deny",label:"deny"}]}},created:function(){this.wafRuleDiag(!1)},methods:{formatRuleData:function(t){var e,l,i,a,r,n;if(t.length<4){switch(i=t[2]?"true":"false",t[1]){case"":l=t[1],r="",a=t[0],!1;break;case"in":l=t[1],r="",a=t[0],!1;break;case"dict":l=t[1],r="",a=JSON.stringify(t[0]),!1;break;case"len":l=t[1],r="",a=t[0],!1;break;case"@token@":l=t[1],r="",a=t[0],!0;break;default:if("list"===t[1]||"in_list"===t[1]||"start_list"===t[1]||"end_list"===t[1]||"rein_list"===t[1]){var s=JSON.stringify(t[0]);l=t[1],r="",a=s.slice(1,s.length-1).replace(/\"/g,""),!1}else l="reg",r=t[1],a=t[0],!1;break}n=""}else{switch(i=t[3]?"true":"false",t[1]){case"":l=t[1],r="",a=t[0],!1;break;case"dict":l=t[1],r="",a=JSON.stringify(t[0]),!1;break;case"len":l=t[1],r="",a=t[0],!1;break;case"@token@":l=t[1],r="",a=t[0],!0;break;default:if("list"===t[1]||"in_list"===t[1]||"start_list"===t[1]||"end_list"===t[1]||"rein_list"===t[1]){s=JSON.stringify(t[0]);l=t[1],r="",a=s.slice(1,s.length-1).replace(/\"/g,""),!1}else l="reg",r=t[1],a=t[0],!1;break}n=t[2]}return e={name:"",symbol:l,negate:i,content:a,jioRegData:r,disabled:!1,headerArg:n},e},wafRuleDiag:function(t){var e=String(this.$route.params["tab"]);if(t){var l,i,a,r;l=t.id,i="on"==t.state,a=t.action,this.headerVisible=!1;var n=this.formatRuleData(t.hostname);switch(n["name"]="host",e){case"referer":var s=this.formatRuleData(t.uri),o=this.formatRuleData(t.referer);s["name"]="uri",o["name"]="referer",r=[n,s,o],"list"===t.referer[1]||"in_list"===t.referer[1]||"start_list"===t.referer[1]||"end_list"===t.referer[1]||"rein_list"===t.referer[1]?(this.listContentArr=t.referer[0],this.dictContentArr={}):"dict"===t.referer[1]?(this.listContentArr=[],this.dictContentArr=t.referer[0]):(this.listContentArr=[],this.dictContentArr={});break;case"header":s=this.formatRuleData(t.uri);var c=this.formatRuleData(t.header);s["name"]="uri",c["name"]="header",r=[n,s,c],"list"===t.header[1]||"in_list"===t.header[1]||"start_list"===t.header[1]||"end_list"===t.header[1]||"rein_list"===t.header[1]?(this.listContentArr=t.header[0],this.dictContentArr={}):"dict"===t.header[1]?(this.listContentArr=[],this.dictContentArr=t.header[0]):(this.listContentArr=[],this.dictContentArr={});break;case"uri":s=this.formatRuleData(t.uri);s["name"]="uri",r=[n,s],"list"===t.uri[1]||"in_list"===t.uri[1]||"start_list"===t.uri[1]||"end_list"===t.uri[1]||"rein_list"===t.uri[1]?(this.listContentArr=t.uri[0],this.dictContentArr={}):"dict"===t.uri[1]?(this.listContentArr=[],this.dictContentArr=t.uri[0]):(this.listContentArr=[],this.dictContentArr={});break;case"useragent":var u=this.formatRuleData(t.useragent);u["name"]="useragent",r=[n,u],"list"===t.useragent[1]||"in_list"===t.useragent[1]||"start_list"===t.useragent[1]||"end_list"===t.useragent[1]||"rein_list"===t.useragent[1]?(this.listContentArr=t.useragent[0],this.dictContentArr={}):"dict"===t.useragent[1]?(this.listContentArr=[],this.dictContentArr=t.useragent[0]):(this.listContentArr=[],this.dictContentArr={});break;case"cookie":var d=this.formatRuleData(t.cookie);d["name"]="cookie",r=[n,d],"list"===t.cookie[1]||"in_list"===t.cookie[1]||"start_list"===t.cookie[1]||"end_list"===t.cookie[1]||"rein_list"===t.cookie[1]?(this.listContentArr=t.cookie[0],this.dictContentArr={}):"dict"===t.cookie[1]?(this.listContentArr=[],this.dictContentArr=t.cookie[0]):(this.listContentArr=[],this.dictContentArr={});break;case"args":var h=this.formatRuleData(t.args);h["name"]="args",r=[n,h],"list"===t.args[1]||"in_list"===t.args[1]||"start_list"===t.args[1]||"end_list"===t.args[1]||"rein_list"===t.args[1]?(this.listContentArr=t.args[0],this.dictContentArr={}):"dict"===t.args[1]?(this.listContentArr=[],this.dictContentArr=t.args[0]):(this.listContentArr=[],this.dictContentArr={});break;case"post":var m=this.formatRuleData(t.post);m["name"]="post",r=[n,m],"list"===t.post[1]||"in_list"===t.post[1]||"start_list"===t.post[1]||"end_list"===t.post[1]||"rein_list"===t.post[1]?(this.listContentArr=t.post[0],this.dictContentArr={}):"dict"===t.post[1]?(this.listContentArr=[],this.dictContentArr=t.post[0]):(this.listContentArr=[],this.dictContentArr={});break}this.headerValue="",this.headerContentArr=["",""],this.regCheckList=[],this.regContentValue="",this.listContentValue="",this.dictContentValue="",this.dictNegate=!0,this.lenContentArr=[0,0],this.ruleForm={id:l,state:i,action:a,table:r}}else this.ruleForm="referer"===e||"header"===e?{id:"",state:!1,action:"deny",table:[{name:"host",symbol:"",negate:"false",content:"",jioRegData:"",disabled:!1,headerArg:""},{name:"uri",symbol:"",negate:"false",content:"",jioRegData:"",disabled:!1,headerArg:""},{name:e,symbol:"",negate:"false",content:"",jioRegData:"",disabled:!1,headerArg:""}]}:{id:"",state:!1,action:"deny",table:[{name:"host",symbol:"",negate:"false",content:"",jioRegData:"",disabled:!1,headerArg:""},{name:e,symbol:"",negate:"false",content:"",jioRegData:"",disabled:!1,headerArg:""}]}},selectSymbol:function(t){this.ruleForm.table[t]["content"]="",this.regCheckList=[],this.regContentValue="",this.listContentArr="",this.listContentArr=[],this.dictContentValue="",this.dictContentArr={},this.headerValue=""},selectContent:function(t,e){var l=String(t.symbol);""===l?"header"===this.ruleForm.table[e]["name"]?(this.rulenameIndex=e,this.ruleTitle=l,this.headerVisible=!0,this.contentVisible=!0):this.ruleTitle=l:"in"===l?"header"===this.ruleForm.table[e]["name"]?(this.rulenameIndex=e,this.ruleTitle=l,this.headerVisible=!0,this.contentVisible=!0):this.ruleTitle=l:"@token@"===l?"header"===this.ruleForm.table[e]["name"]?(this.rulenameIndex=e,this.ruleTitle=l,this.headerVisible=!0,this.contentVisible=!0):(this.ruleTitle=l,this.ruleForm.table[e]["content"]="true",this.ruleForm.table[e]["disabled"]=!0):"header"===this.ruleForm.table[e]["name"]?(this.rulenameIndex=e,this.ruleTitle=l,this.headerVisible=!0,this.contentVisible=!0):(this.ruleTitle=l,this.rulenameIndex=e,this.contentVisible=!0)},pushContent:function(){var t=String(this.ruleForm.table[this.rulenameIndex]["symbol"]);switch(t){case"reg":var e=this.regCheckList.map(function(t){return t.name}).toString().replace(/[,]/g,"");this.ruleForm.table[this.rulenameIndex]["jioRegData"]=e,this.ruleForm.table[this.rulenameIndex]["content"]=this.regContentValue;break;case"dict":this.ruleForm.table[this.rulenameIndex]["content"]=JSON.stringify(this.dictContentArr);break;case"len":this.ruleForm.table[this.rulenameIndex]["content"]=this.lenContentArr.toString();break;default:if("list"===t||"in_list"===t||"start_list"===t||"end_list"===t||"rein_list"===t){var l=this.listContentArr.map(function(t){return t}).toString().replace(/[]/g,"");this.ruleForm.table[this.rulenameIndex]["content"]=l}else this.ruleForm.table[this.rulenameIndex]["content"]="@token@"===t?"true":this.headerValue;break}this.ruleForm.table[this.rulenameIndex]["headerArg"]=this.headerContentArr,this.headerVisible=!1,this.contentVisible=!1},addRule:function(){this.$emit("my-event",this.editorId)},handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},addList:function(t){switch(t){case"dict":"true"==this.dictNegate?this.$set(this.dictContentArr,this.dictContentValue,!0):this.$set(this.dictContentArr,this.dictContentValue,!1);break;default:this.listContentArr.push(this.listContentValue);break}},removeList:function(t,e){switch(t){case"dict":this.$delete(this.dictContentArr,e);break;default:this.listContentArr.splice(e,1);break}}},components:{WafDivider:r},watch:{$route:function(t,e){this.wafRuleDiag(!1)}}},s=n,o=l("2877"),c=Object(o["a"])(s,i,a,!1,null,"68ea66f0",null);e["default"]=c.exports}}]);